<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The K-Mart Countdown</title>
    <link rel="stylesheet" href="../../secret-annex-snes.css" />
    <link rel="stylesheet" href="../common.css" />
    <link rel="stylesheet" href="k-mart-countdown.css" />
  </head>
  <body class="secret-annex-snes countdown-cabinet">
    <a class="skip-link" href="#main-content">Skip to game</a>
    <div class="scanlines" aria-hidden="true"></div>
    <header class="page-header">
      <p class="eyebrow">Level 29 · 1989 Arcade</p>
      <h1>The K-Mart Countdown</h1>
      <p class="subtitle">
        Count the spill in a blink. One clean read, one decisive tap—make the Rain Man math sing before the multiplier melts.
      </p>
    </header>
    <main id="main-content" class="page-layout">
      <section class="briefing" aria-labelledby="briefing-title">
        <h2 id="briefing-title">Stage Notes</h2>
        <p>
          Charlie just kicked the matchsticks across the bargain bin aisle. You get a single look before security swarms. Track the
          pattern, trust the count, and log the final tally before the multiplier evaporates.
        </p>
        <div class="briefing-grid">
          <section aria-labelledby="round-cadence-title">
            <h3 id="round-cadence-title">Round Cadence</h3>
            <ul class="callouts">
              <li>
                <strong>Setup:</strong> The spill snaps into view with a clatter. Later rounds widen the pile and tangle the sticks.
              </li>
              <li>
                <strong>Observe:</strong> Observation windows shrink from five seconds to a breathless three. Train your scan path early.
              </li>
              <li>
                <strong>Calculate:</strong> The pile blanks out. Type your final count and commit before the multiplier drains dry.
              </li>
            </ul>
          </section>
          <section aria-labelledby="scoring-rules-title">
            <h3 id="scoring-rules-title">Scoring Intel</h3>
            <ul class="callouts">
              <li>
                <strong>Accuracy:</strong> Nail the exact count for 10,000 points. Near-misses decay exponentially—being off by one still nets
                8,000, while a ten-stick miss drops to 500.
              </li>
              <li>
                <strong>Quick Guess:</strong> The multiplier begins at ×5 and ticks down the longer you hesitate. Fire fast for massive scores,
                but reckless misses trigger penalty fees.
              </li>
              <li>
                <strong>Verification:</strong> Every submission rewinds the spill, counting each stick to confirm the real total against your guess.
              </li>
            </ul>
          </section>
        </div>
      </section>
      <section class="simulator" aria-labelledby="simulator-title">
        <div class="simulator-header">
          <h2 id="simulator-title">Spill Response Console</h2>
          <div class="simulator-controls" role="group" aria-label="Round controls">
            <button type="button" class="action-button" id="start-session">Start Session</button>
            <button type="button" class="action-button" id="next-round" disabled>Next Round</button>
          </div>
        </div>
        <p class="simulator-help">
          Watch the spill, breathe once, then lock your answer. The HUD mirrors a seven-segment calculator so every guess feels like a
          high-stakes tally on the sales floor.
        </p>
        <div class="status-board" role="group" aria-label="Countdown status">
          <div class="status-tile">
            <span class="status-label">Phase</span>
            <span class="status-value" id="phase-indicator">Awaiting session</span>
          </div>
          <div class="status-tile">
            <span class="status-label">Total Score</span>
            <span class="status-value score-digits" id="score-total">000000</span>
          </div>
          <div class="status-tile">
            <span class="status-label">Quick Guess</span>
            <span class="status-value score-digits" id="multiplier-readout">×5.0</span>
          </div>
          <div class="status-tile">
            <span class="status-label">Accuracy Delta</span>
            <span class="status-value score-digits" id="accuracy-readout">±0</span>
          </div>
        </div>
        <div class="round-hud" role="group" aria-label="Round tracking">
          <div class="round-tile">
            <span class="round-label">Round</span>
            <span class="round-value score-digits" id="round-counter">0 / 0</span>
          </div>
          <div class="round-tile">
            <span class="round-label">Observation</span>
            <span class="round-value score-digits" id="observation-timer">0.0s</span>
          </div>
          <div class="round-tile">
            <span class="round-label">Recount</span>
            <span class="round-value score-digits" id="recount-value">000</span>
          </div>
        </div>
        <div class="matchstage" id="matchstage" aria-live="off">
          <div class="matchstage-surface">
            <div class="matchstick-field" id="matchstick-field" aria-hidden="true"></div>
            <div class="phase-banner" id="phase-banner" aria-hidden="true"></div>
          </div>
          <form id="guess-form" class="guess-panel" autocomplete="off">
            <label class="guess-label" for="guess-input">Final Count</label>
            <div class="guess-input-wrap">
              <input type="number" inputmode="numeric" id="guess-input" name="guess" required aria-label="Enter your final matchstick count" />
              <button type="submit" class="action-button" id="final-count" disabled>Commit Count</button>
            </div>
            <p class="guess-hint">Submit before the multiplier drains. Enter clears on focus for rapid retrials.</p>
          </form>
        </div>
        <p id="status-readout" class="mission-status">Press Start Session to begin the countdown drill.</p>
        <div class="summary-panel" id="summary-panel" hidden aria-live="polite">
          <h3>Session Wrap-Up</h3>
          <p id="summary-overview"></p>
          <table class="summary-table">
            <thead>
              <tr>
                <th scope="col">Round</th>
                <th scope="col">Guess</th>
                <th scope="col">Actual</th>
                <th scope="col">Δ</th>
                <th scope="col">Multiplier</th>
                <th scope="col">Score</th>
              </tr>
            </thead>
            <tbody id="summary-body"></tbody>
          </table>
          <button type="button" class="action-button" id="replay-session">Run It Back</button>
        </div>
        <section class="intel-feed" aria-labelledby="intel-feed-title">
          <h3 id="intel-feed-title">Sales Floor Log</h3>
          <ul id="event-log"></ul>
        </section>
      </section>
    </main>
    <footer class="page-footer">
      <p>
        Pro tip: Anchor your first glance on clusters of five before chasing singles. Whisper the subtotal, then smash the commit button while
        the multiplier is still glowing.
      </p>
    </footer>
    <script type="module" src="k-mart-countdown.js"></script>
  </body>
</html>
