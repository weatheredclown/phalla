<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Family Flux</title>
    <link rel="stylesheet" href="../../secret-annex-snes.css" />
    <link rel="stylesheet" href="../common.css" />
    <link rel="stylesheet" href="family-flux.css" />
  </head>
  <body class="secret-annex-snes">
    <a class="skip-link" href="#main-content">Skip to game</a>
    <div class="scanlines" aria-hidden="true"></div>
    <header class="page-header">
      <p class="eyebrow">Level 25 · Parenthood Cabinet</p>
      <h1>Family Flux</h1>
      <p class="subtitle">
        Shepherd the Buckman crew through escalating family crosswinds. Decide fast, balance heart and risk, and keep the Family
        Harmony meter alive.
      </p>
    </header>
    <main id="main-content" class="page-layout">
      <section class="briefing" aria-labelledby="briefing-title">
        <h2 id="briefing-title">Stage Notes</h2>
        <p>
          Each dilemma arrives as a rapid-fire comic panel. Two buttons. One ticking Patience bar. Your call sets the tone for
          the next scene and shifts the Family Harmony score. Safe plays guarantee small gains; daring gambles broadcast the
          stakes with crystal-clear odds and can rocket the meter or send it crashing.
        </p>
        <ul class="callouts">
          <li><strong>Harmony HUD:</strong> Track your score up top. Every decision animates the meter so you can feel the swing.</li>
          <li><strong>Patience timer:</strong> React before the bar drains. Freezing out counts as a harsh miss.</li>
          <li><strong>Branches:</strong> Risky wins can unlock bonus scenes with tougher stakes and bigger payouts.</li>
        </ul>
        <section class="legend" aria-labelledby="legend-title">
          <h3 id="legend-title">Harmony Feedback</h3>
          <dl>
            <div>
              <dt><span class="legend-swatch positive"></span> Positive Outcome</dt>
              <dd>Warm palette, celebratory chime, and a green Harmony surge.</dd>
            </div>
            <div>
              <dt><span class="legend-swatch neutral"></span> Measured Response</dt>
              <dd>Soft amber glow keeps the family steady—no fireworks, no shakes.</dd>
            </div>
            <div>
              <dt><span class="legend-swatch negative"></span> Fallout</dt>
              <dd>Muted greys, a dissonant chord, and a red score dip warn of trouble.</dd>
            </div>
          </dl>
        </section>
      </section>
      <section class="simulator" aria-labelledby="simulator-title">
        <div class="simulator-header">
          <h2 id="simulator-title">Family Control Booth</h2>
          <div class="simulator-controls">
            <button type="button" class="action-button" id="start-run">Start Session</button>
            <button type="button" class="action-button" id="reset-run" disabled>Reset</button>
          </div>
        </div>
        <div class="hud" aria-live="polite">
          <div class="harmony-display" id="harmony-display" aria-label="Family Harmony" role="group">
            <span class="harmony-label" id="harmony-label">Family Harmony</span>
            <span class="harmony-value" id="harmony-value">0</span>
          </div>
          <div class="patience" role="progressbar" aria-label="Patience" aria-valuemin="0" aria-valuemax="100" aria-valuenow="100">
            <span class="patience-label">Patience</span>
            <div class="patience-bar" id="patience-bar"></div>
          </div>
          <p class="progress-readout" id="progress-readout">No dilemmas active.</p>
        </div>
        <article class="scenario" id="scenario" hidden>
          <header class="scenario-header">
            <p class="scenario-eyebrow" id="scenario-level">Scenario</p>
            <h3 class="scenario-title" id="scenario-title">Awaiting start</h3>
          </header>
          <div class="scenario-body">
            <div class="scenario-panel" id="scenario-panel" aria-hidden="true">
              <div class="panel-ink" id="panel-art"></div>
            </div>
            <div class="scenario-copy">
              <p id="scenario-description"></p>
            </div>
          </div>
          <footer class="scenario-footer">
            <div class="choice-grid">
              <button type="button" class="choice-button" id="choice-a" data-choice="a">
                <span class="choice-label" id="choice-a-label">Choice A</span>
                <span class="choice-detail" id="choice-a-detail"></span>
                <span class="choice-risk" id="choice-a-risk"></span>
              </button>
              <button type="button" class="choice-button" id="choice-b" data-choice="b">
                <span class="choice-label" id="choice-b-label">Choice B</span>
                <span class="choice-detail" id="choice-b-detail"></span>
                <span class="choice-risk" id="choice-b-risk"></span>
              </button>
            </div>
            <div class="scenario-actions">
              <button type="button" class="action-button" id="next-button" disabled>Next Dilemma</button>
            </div>
          </footer>
        </article>
        <section class="status-area" aria-labelledby="status-title">
          <h3 id="status-title">Status</h3>
          <p id="status-bar">Start the session to begin juggling crises.</p>
          <h3 id="log-title">Beat Log</h3>
          <ul id="event-log"></ul>
        </section>
        <section class="wrap-up" id="wrap-up" hidden aria-live="polite">
          <header class="wrap-header">
            <h3>Session Wrap-Up</h3>
            <p id="wrap-summary"></p>
          </header>
          <div class="wrap-score" id="wrap-score"></div>
          <div class="wrap-tree">
            <h4>Decision Tree</h4>
            <ol class="decision-tree" id="decision-tree"></ol>
          </div>
          <div class="wrap-actions">
            <button type="button" class="action-button" id="replay-button">Run It Again</button>
          </div>
        </section>
      </section>
    </main>
    <footer class="page-footer">
      <p>Tip: A daring win can unlock surprise scenes. Just be sure you have the Harmony padding to weather the fallout.</p>
    </footer>
    <script type="module" src="family-flux.js"></script>
  </body>
</html>
