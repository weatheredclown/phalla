<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flapjack Flip-Out</title>
    <link rel="stylesheet" href="../../secret-annex-snes.css" />
    <link rel="stylesheet" href="../common.css" />
    <link rel="stylesheet" href="flapjack-flip-out.css" />
  </head>
  <body class="secret-annex-snes flapjack-cabinet">
    <a class="skip-link" href="#main-content">Skip to game</a>
    <div class="scanlines" aria-hidden="true"></div>
    <header class="page-header">
      <p class="eyebrow">Level 29 · 1989 Arcade</p>
      <h1>Flapjack Flip-Out</h1>
      <p class="subtitle">
        Balance a teetering tower of skillet-sized pancakes while Uncle Buck's mystery spatula keeps the brunch rush rolling.
      </p>
    </header>
    <main id="main-content" class="page-layout">
      <section class="briefing" aria-labelledby="briefing-title">
        <h2 id="briefing-title">Kitchen Briefing</h2>
        <p>
          Welcome to the late-night pancake line. You steer the plate while the unseen spatula flings flapjacks from offstage.
          A centered catch keeps the stack tidy. Slide even a little and the wobble ripples through every layer of batter.
        </p>
        <ul class="callouts">
          <li>
            <strong>Setup phase:</strong> Start with a calm plate and perfectly circular pancakes. Get your footing before the
            tempo spikes.
          </li>
          <li>
            <strong>Action phase:</strong> Each launch arrives faster with weirder sizes—hefty griddles, mini silver dollars, and
            burnt brittle discs that can shatter if squeezed too hard.
          </li>
          <li>
            <strong>Risk vs. reward:</strong> Off-center stacks wobble. Tap <em>Nudge</em> to re-center, but overdo it and the
            whole tower cascades into syrupy chaos.
          </li>
          <li>
            <strong>Win condition:</strong> Chase the tallest possible stack height before you drop a pancake or collapse the
            tower. Height is king; total pancakes is your flair bonus.
          </li>
        </ul>
        <section class="controls" aria-labelledby="controls-title">
          <h3 id="controls-title">Controls</h3>
          <dl>
            <div>
              <dt>Move plate</dt>
              <dd>Arrow keys or <strong>A/D</strong> to slide. Mouse or touch drag inside the kitchen works too.</dd>
            </div>
            <div>
              <dt>Start round</dt>
              <dd>Press <strong>Begin Service</strong> to cue the spatula.</dd>
            </div>
            <div>
              <dt>Nudge stack</dt>
              <dd>
                Tap <strong>N</strong> or the <strong>Nudge</strong> button to gamble on re-centering. Higher wobble means higher
                bust odds.
              </dd>
            </div>
            <div>
              <dt>Reset</dt>
              <dd>Press <strong>Reset Kitchen</strong> or hit <strong>R</strong> to start a fresh service.</dd>
            </div>
          </dl>
        </section>
      </section>
      <section class="arena" aria-labelledby="arena-title">
        <div class="arena-header">
          <h2 id="arena-title">Buck's Midnight Kitchen</h2>
          <div class="arena-controls" role="group" aria-label="Action controls">
            <button type="button" class="action-button" id="start-service">Begin Service</button>
            <button type="button" class="action-button" id="nudge-stack" disabled>Nudge</button>
            <button type="button" class="action-button" id="reset-kitchen">Reset Kitchen</button>
          </div>
        </div>
        <div class="status-rail">
          <div class="score-card" aria-live="polite">
            <header class="score-card-header">
              <h3>Stack Height</h3>
              <span class="score-label">Current</span>
            </header>
            <p class="score-value" id="height-display">0 cm</p>
            <p class="score-note">Peak: <span id="peak-display">0 cm</span></p>
          </div>
          <div class="score-card" aria-live="polite">
            <header class="score-card-header">
              <h3>Pancake Count</h3>
              <span class="score-label">Served</span>
            </header>
            <p class="score-value" id="count-display">0</p>
            <p class="score-note">Types: <span id="type-display">—</span></p>
          </div>
          <div class="score-card" aria-live="polite">
            <header class="score-card-header">
              <h3>Stability</h3>
              <span class="score-label">Risk Meter</span>
            </header>
            <div class="stability-meter" role="meter" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" aria-label="Stack wobble">
              <div class="stability-fill" id="stability-fill"></div>
            </div>
            <p class="score-note" id="stability-note">Plate is steady.</p>
          </div>
        </div>
        <div class="status-bar" id="status-bar">Slide into position and begin service when ready.</div>
        <div class="kitchen-stage">
          <canvas id="stack-canvas" width="900" height="540" aria-label="Pancake stacking stage"></canvas>
          <div class="stage-overlay">
            <div class="tempo" id="tempo-indicator">Tempo: 1</div>
            <div class="pancake-callout" id="next-callout" hidden></div>
          </div>
        </div>
        <section class="log" aria-labelledby="log-title">
          <h3 id="log-title">Service Log</h3>
          <ul id="service-log"></ul>
        </section>
      </section>
    </main>
    <footer class="page-footer">
      <p>
        Tip: Burnt pancakes hate compression. If you catch one off-center, either nudge immediately or prepare for a crunchy
        collapse.
      </p>
    </footer>
    <div class="wrapup" id="wrapup" hidden role="dialog" aria-modal="true" aria-labelledby="wrapup-title">
      <div class="wrapup-panel">
        <header class="wrapup-header">
          <h2 id="wrapup-title">Service Complete</h2>
          <p id="wrapup-subtitle"></p>
        </header>
        <div class="wrapup-body">
          <dl class="wrapup-stats">
            <div>
              <dt>Final Height</dt>
              <dd id="wrapup-height">0 cm</dd>
            </div>
            <div>
              <dt>Total Pancakes</dt>
              <dd id="wrapup-total">0</dd>
            </div>
            <div>
              <dt>Risk Taken</dt>
              <dd id="wrapup-risk">None</dd>
            </div>
          </dl>
          <figure class="wrapup-photo">
            <img id="wrapup-photo" alt="Photo of the tallest pancake tower" />
            <figcaption id="wrapup-photo-caption">Tallest tower snapshot</figcaption>
          </figure>
        </div>
        <footer class="wrapup-footer">
          <button type="button" class="action-button" id="wrapup-rematch">Run It Back</button>
          <button type="button" class="action-button" id="wrapup-close">Return to Cabinet</button>
        </footer>
      </div>
    </div>
    <script type="module" src="flapjack-flip-out.js"></script>
  </body>
</html>
