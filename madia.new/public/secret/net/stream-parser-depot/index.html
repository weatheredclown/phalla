<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Stream Parser Depot</title>
    <link rel="stylesheet" href="../common.css" />
    <link rel="stylesheet" href="../widgets.css" />
    <link rel="stylesheet" href="./stream-parser-depot.css" />
  </head>
  <body>
    <header>
      <div class="header-bar">
        <div class="header-text">
          <p>Layer 03 Â· Log Sieve</p>
          <h1>Stream Parser Depot</h1>
        </div>
        <button
          type="button"
          class="fullscreen-toggle"
          data-role="fullscreen-toggle"
          data-fullscreen="false"
          aria-pressed="false"
        >
          <span class="fullscreen-toggle__label fullscreen-toggle__label--enter" data-state="enter">Enter full screen</span>
          <span class="fullscreen-toggle__label fullscreen-toggle__label--exit" data-state="exit">Exit full screen</span>
        </button>
      </div>
      <p>
        The overnight shift dumped raw radius logs into a flat file. Pick the awk and sed snippets that clean the authentication
        report for the pager message.
      </p>
    </header>
    <main>
      <section class="control-panel" aria-labelledby="log-heading">
        <h2 id="log-heading">Sample payload</h2>
        <div class="log-panel">
          <pre>rad_recv: Access-Request packet from host 10.2.9.12:59636, id=212, length=117
User-Name = "dli"
User-Password = ""
NAS-IP-Address = 10.2.9.12
NAS-Port = 0
Calling-Station-Id = "00-00-F8-9A-42-10"
Connect-Info = "CONNECT 64000/ARQ/V34/LAPM/V42BIS"
rad_reply: Access-Accept packet
rad_recv: Access-Request packet from host 10.2.9.14:59647, id=213, length=120
User-Name = "guest"
User-Password = "guest"
NAS-Port = 1
rad_reply: Access-Reject packet
</pre>
        </div>
      </section>
      <section class="control-panel" aria-labelledby="parser-heading">
        <h2 id="parser-heading">Pipeline builder</h2>
        <p>Choose the command pair that yields <code>dli CONNECT 64000/ARQ/V34/LAPM/V42BIS</code>.</p>
        <form id="parser-form" class="form-grid">
          <fieldset>
            <legend>Step selection</legend>
            <div class="parser-grid">
              <div class="parser-field">
                <p class="control-label" id="filter-label">Filter stage</p>
                <div class="neon-select" data-widget="neon-select" aria-labelledby="filter-label">
                  <input type="hidden" name="filter" value="" />
                  <div class="neon-select__rail">
                    <button class="neon-select__option" data-value="" type="button">
                      <span class="neon-select__option-title">--</span>
                    </button>
                    <button class="neon-select__option" data-value="awk-user" type="button">
                      <span class="neon-select__option-title">awk '/User-Name/ {u=$3}'</span>
                    </button>
                    <button class="neon-select__option" data-value="awk-pair" type="button">
                      <span class="neon-select__option-title">awk '/Access-Request/ {print $NF}'</span>
                    </button>
                    <button class="neon-select__option" data-value="sed-block" type="button">
                      <span class="neon-select__option-title">sed -n '1,6p'</span>
                    </button>
                    <button class="neon-select__option" data-value="sed-pull" type="button">
                      <span class="neon-select__option-title">sed -n '/Access-Accept/,$p'</span>
                    </button>
                  </div>
                </div>
              </div>
              <div class="parser-field">
                <p class="control-label" id="format-label">Format stage</p>
                <div class="neon-select" data-widget="neon-select" aria-labelledby="format-label">
                  <input type="hidden" name="format" value="" />
                  <div class="neon-select__rail">
                    <button class="neon-select__option" data-value="" type="button">
                      <span class="neon-select__option-title">--</span>
                    </button>
                    <button class="neon-select__option" data-value="awk-print" type="button">
                      <span class="neon-select__option-title">awk 'NR==1 {printf &quot;%s &quot;, $1}'</span>
                    </button>
                    <button class="neon-select__option" data-value="awk-join" type="button">
                      <span class="neon-select__option-title">awk 'NR%2==1 {printf $0 &quot; &quot;}'</span>
                    </button>
                    <button class="neon-select__option" data-value="sed-trim" type="button">
                      <span class="neon-select__option-title">sed 's/["=]//g;s/User-Name //;s/\\t//g'</span>
                    </button>
                    <button class="neon-select__option" data-value="sed-collapse" type="button">
                      <span class="neon-select__option-title">sed -n 's/.*= \"\(.*\)\"/\1/p'</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </fieldset>
          <button type="submit" class="execute-button">Run pipeline</button>
        </form>
        <div id="status-board" class="status-board" aria-live="polite">Awaiting command pair.</div>
        <div class="pipeline-visual" aria-hidden="true">
          <div class="pipeline-stage" data-stage="filter">
            <span class="stage-label">Filter</span>
            <span class="stage-code" data-code="filter">--</span>
          </div>
          <div class="pipeline-stage" data-stage="format">
            <span class="stage-label">Format</span>
            <span class="stage-code" data-code="format">--</span>
          </div>
          <div class="pipeline-output">
            <span class="output-label">Sample output</span>
            <span class="output-line" id="pipeline-output">--</span>
          </div>
        </div>
        <div class="pipeline-meter" aria-hidden="true">
          <span class="meter-label">Pipeline integrity</span>
          <div class="meter-bar">
            <span class="meter-fill"></span>
          </div>
          <div class="meter-pips">
            <span class="meter-pip" data-index="0"></span>
            <span class="meter-pip" data-index="1"></span>
          </div>
        </div>
      </section>
    </main>
    <footer>Keep the pager brief and the regex sharp.</footer>
    <script src="../widgets.js" type="module"></script>
    <script type="module" src="./stream-parser-depot.js"></script>
  </body>
</html>
