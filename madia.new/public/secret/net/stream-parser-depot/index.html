<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Stream Parser Depot</title>
    <link rel="stylesheet" href="../common.css" />
    <link rel="stylesheet" href="./stream-parser-depot.css" />
  </head>
  <body>
    <header>
      <p>Layer 03 Â· Log Sieve</p>
      <h1>Stream Parser Depot</h1>
      <p>
        The overnight shift dumped raw radius logs into a flat file. Pick the awk and sed snippets that clean the
        authentication report for the pager message.
      </p>
    </header>
    <main>
      <section class="control-panel" aria-labelledby="log-heading">
        <h2 id="log-heading">Sample payload</h2>
        <div class="log-panel">
          <pre>
rad_recv: Access-Request packet from host 10.2.9.12:59636, id=212, length=117
User-Name = "dli"
User-Password = ""
NAS-IP-Address = 10.2.9.12
NAS-Port = 0
Calling-Station-Id = "00-00-F8-9A-42-10"
Connect-Info = "CONNECT 64000/ARQ/V34/LAPM/V42BIS"
rad_reply: Access-Accept packet
rad_recv: Access-Request packet from host 10.2.9.14:59647, id=213, length=120
User-Name = "guest"
User-Password = "guest"
NAS-Port = 1
rad_reply: Access-Reject packet
          </pre>
        </div>
      </section>
      <section class="control-panel" aria-labelledby="parser-heading">
        <h2 id="parser-heading">Pipeline builder</h2>
        <p>Choose the command pair that yields <code>dli CONNECT 64000/ARQ/V34/LAPM/V42BIS</code>.</p>
        <form id="parser-form" class="form-grid">
          <fieldset>
            <legend>Step selection</legend>
            <div class="parser-grid">
              <label>
                Filter stage
                <select name="filter">
                  <option value="">--</option>
                  <option value="awk-user">awk '/User-Name/ {u=$3}'</option>
                  <option value="awk-pair">awk '/Access-Request/ {print $NF}'</option>
                  <option value="sed-block">sed -n '1,6p'</option>
                  <option value="sed-pull">sed -n '/Access-Accept/,$p'</option>
                </select>
              </label>
              <label>
                Format stage
                <select name="format">
                  <option value="">--</option>
                  <option value="awk-print">awk 'NR==1 {printf "%s ", $1}'</option>
                  <option value="awk-join">awk 'NR%2==1 {printf $0 " "}'</option>
                  <option value="sed-trim">sed 's/["=]//g;s/User-Name //;s/\\t//g'</option>
                  <option value="sed-collapse">sed -n 's/.*= \"\(.*\)\"/\1/p'</option>
                </select>
              </label>
            </div>
          </fieldset>
          <button type="submit" class="execute-button">Run pipeline</button>
        </form>
        <div id="status-board" class="status-board" aria-live="polite">Awaiting command pair.</div>
        <div class="pipeline-visual" aria-hidden="true">
          <div class="pipeline-stage" data-stage="filter">
            <span class="stage-label">Filter</span>
            <span class="stage-code" data-code="filter">--</span>
          </div>
          <div class="pipeline-stage" data-stage="format">
            <span class="stage-label">Format</span>
            <span class="stage-code" data-code="format">--</span>
          </div>
          <div class="pipeline-output">
            <span class="output-label">Sample output</span>
            <span class="output-line" id="pipeline-output">--</span>
          </div>
        </div>
        <div class="pipeline-meter" aria-hidden="true">
          <span class="meter-label">Pipeline integrity</span>
          <div class="meter-bar">
            <span class="meter-fill"></span>
          </div>
          <div class="meter-pips">
            <span class="meter-pip" data-index="0"></span>
            <span class="meter-pip" data-index="1"></span>
          </div>
        </div>
      </section>
    </main>
    <footer>Keep the pager brief and the regex sharp.</footer>
    <script type="module" src="./stream-parser-depot.js"></script>
  </body>
</html>
