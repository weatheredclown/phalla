<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Phalla Control Center</title>
    <link rel="stylesheet" href="../styles.css" />
  </head>
  <body>
    <header>
      <h1>Phalla Control Center</h1>
      <p id="authStatus" class="subtitle">Checking sign-in status…</p>
      <div class="auth-controls">
        <button id="signInButton" class="primary" type="button">Sign in with Google</button>
        <button id="signOutButton" class="secondary" type="button" hidden>Sign out</button>
      </div>
    </header>

    <main>
      <section class="panel">
        <div class="panel-header">
          <h2>Threads</h2>
          <div class="panel-actions">
            <button id="newThreadButton" class="primary" type="button">New thread</button>
          </div>
        </div>
        <ul id="threadsList" class="list" aria-live="polite"></ul>
      </section>

      <section class="panel">
        <div class="panel-header">
          <div>
            <h2 id="threadTitle">Select a thread</h2>
            <p id="threadMetadata" class="metadata"></p>
          </div>
          <div class="panel-actions">
            <button id="refreshThread" class="secondary" type="button">Refresh</button>
            <button id="deleteThread" class="secondary" type="button" hidden>Delete</button>
          </div>
        </div>
        <ul id="postsList" class="list posts" aria-live="polite"></ul>
        <form id="replyForm" class="reply-form" hidden>
          <label for="replyBody">Post reply</label>
          <textarea id="replyBody" rows="5" placeholder="Share an update with the village" required></textarea>
          <div class="panel-actions">
            <button class="secondary" type="button" id="cancelReplyButton">Cancel</button>
            <button class="primary" type="submit">Submit reply</button>
          </div>
        </form>
      </section>

      <section class="panel">
        <div class="panel-header">
          <h2>Vote tracker</h2>
          <div class="panel-actions">
            <button id="recordVoteButton" class="primary" type="button">Record vote</button>
          </div>
        </div>
        <div class="table-wrapper">
          <table id="voteTable" class="vote-table">
            <thead>
              <tr>
                <th scope="col">Player</th>
                <th scope="col">Votes</th>
                <th scope="col">Notes</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section class="panel">
        <div class="panel-header">
          <div>
            <h2>Game moderation</h2>
            <p id="gameStatus" class="metadata status-message" role="status"></p>
          </div>
          <div class="panel-actions">
            <button id="phaseToggleOpenButton" class="secondary" type="button">Toggle open</button>
            <button id="phaseToggleActiveButton" class="secondary" type="button">Toggle active</button>
            <button id="phaseNextDayButton" class="secondary" type="button">Advance day</button>
          </div>
        </div>

        <form id="gameMetadataForm" class="game-metadata" autocomplete="off">
          <label class="form-field">
            Managed game
            <select id="gameSelect" required>
              <option value="">Select a game…</option>
            </select>
          </label>

          <div class="form-grid">
            <label class="form-field">
              Title
              <input id="gameNameInput" type="text" placeholder="Game title" />
            </label>
            <label class="form-field">
              Day
              <input id="gameDayInput" type="number" min="0" value="0" />
            </label>
            <label class="form-field">
              Phase label
              <input id="gamePhaseInput" type="text" placeholder="e.g. Day, Night" />
            </label>
          </div>

          <div class="toggle-row">
            <label class="toggle">
              <input id="gameOpenInput" type="checkbox" />
              <span>Open to new players</span>
            </label>
            <label class="toggle">
              <input id="gameActiveInput" type="checkbox" />
              <span>Game is active</span>
            </label>
            <div class="phase-shortcuts">
              <span>Quick set:</span>
              <button id="phaseSetDayButton" class="chip" type="button">Day</button>
              <button id="phaseSetNightButton" class="chip" type="button">Night</button>
            </div>
          </div>

          <div class="panel-actions">
            <button class="primary" type="submit">Save metadata</button>
            <button id="refreshGameButton" class="secondary" type="button">Refresh</button>
          </div>
        </form>

        <div class="roster" aria-live="polite">
          <div class="roster-header">
            <h3>Roster</h3>
            <p id="rosterStatus" class="metadata status-message" role="status"></p>
          </div>
          <div class="table-wrapper">
            <table class="roster-table">
              <thead>
                <tr>
                  <th scope="col">Player</th>
                  <th scope="col">Role</th>
                  <th scope="col">Alignment</th>
                  <th scope="col">Status</th>
                  <th scope="col">Posts left</th>
                  <th scope="col">Moderator notes</th>
                  <th scope="col" class="actions">Actions</th>
                </tr>
              </thead>
              <tbody id="rosterTableBody"></tbody>
            </table>
          </div>
        </div>
      </section>
    </main>

    <dialog id="threadDialog">
      <form method="dialog" id="threadForm" class="dialog-form">
        <h2>Create a new thread</h2>
        <label for="threadTitleInput">Title</label>
        <input id="threadTitleInput" type="text" name="title" required />
        <label for="threadBodyInput">Opening post</label>
        <textarea
          id="threadBodyInput"
          name="body"
          rows="6"
          placeholder="Welcome players, describe the game, or log the next phase update"
          required
        ></textarea>
        <menu class="dialog-actions">
          <button value="cancel" type="reset" class="secondary">Cancel</button>
          <button value="default" class="primary">Create thread</button>
        </menu>
      </form>
    </dialog>

    <dialog id="voteDialog">
      <form method="dialog" id="voteForm" class="dialog-form">
        <h2>Record a vote</h2>
        <label for="votePlayerInput">Player</label>
        <input id="votePlayerInput" type="text" name="player" required />
        <label for="voteCountInput">Vote count</label>
        <input id="voteCountInput" type="number" name="votes" min="0" value="1" required />
        <label for="voteNotesInput">Notes</label>
        <textarea
          id="voteNotesInput"
          name="notes"
          rows="4"
          placeholder="Include context like vote source or tie-breakers"
        ></textarea>
        <menu class="dialog-actions">
          <button value="cancel" type="reset" class="secondary">Cancel</button>
          <button value="default" class="primary">Save vote</button>
        </menu>
      </form>
    </dialog>

    <script type="module" src="../script.js"></script>
  </body>
</html>
